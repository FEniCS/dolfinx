# Swig test

DOLFIN_CFLAGS = `dolfin-config --cflags`
DOLFIN_LFLAGS = `dolfin-config --libs`
CXX = `dolfin-config --compiler`
SWIG = swig

CPPFLAGS = @PYTHON_CPPFLAGS@ $(DOLFIN_CFLAGS) -I. -g -fPIC
LFLAGS = $(DOLFIN_LFLAGS)
SWIGFLAGS = $(DOLFIN_CFLAGS)

default: all

all: dolfin/dolfin.py dolfin/_dolfin.so

dolfin/dolfin.py: dolfin.i
	$(SWIG) -python -c++ -nodefault -dirprot $(SWIGFLAGS) -outdir dolfin $<
	mv dolfin_wrap.cxx dolfin_wrap.cpp

dolfin/_dolfin.so: dolfin_wrap.o PoissonTest.o SettingsGlue.o
	$(CXX) -g -shared dolfin_wrap.o PoissonTest.o SettingsGlue.o -o $@ $(LFLAGS) 

dolfin_wrap.o: dolfin_wrap.cpp

install:
	python setup.py install

clean:
	rm -f dolfin/dolfin.py dolfin.pyc dolfin/_dolfin.so dolfin_wrap.o dolfin_wrap.cpp SettingsGlue.o PoissonTest.o *~

