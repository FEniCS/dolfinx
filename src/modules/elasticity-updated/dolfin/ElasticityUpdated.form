# Test form for updated elasticity

name = "ElasticityUpdated"
element1 = FiniteElement("Discontinuous vector Lagrange", "tetrahedron", 0, 9)
element2 = FiniteElement("Vector Lagrange", "tetrahedron", 1)

nuv = Constant()	# viscosity coefficient

v = TestFunction(element2)
f = Function(element2)
sigma = Function(element1)
epsilon = Function(element1)

def tomatrix(q):
    return [ [q[3 * i + j] for i in range(3)] for j in range(3) ]

sigmam = tomatrix(sigma)
epsilonm = tomatrix(epsilon)

L = (f[i] * v[i] -
	dot(sigmam, grad(v)) -
	nuv * (dot(epsilonm, grad(v)))) * dx
